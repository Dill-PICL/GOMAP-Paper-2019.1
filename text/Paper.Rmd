---
title: 'TBD'
author: "The Pickles"
date: "Febcember 32nd 3023"
language: en-US
output: pdf_document
---

```{r load_libs, include=F}
library(knitr)
library(kableExtra)
knitr::opts_chunk$set(echo=FALSE)
```

# Methods

## Clean up
All functional annotation sets were cleaned up the following way (using definitions from the Gene Ontology version 2019-07-01):

1. Any annotations where the GO accession was marked as obsolete were removed.
2. Some terms in the GO have 'alternative ids'. When naively removing duplicates, two entries will not be recognized as duplicates if they have different accessions pointing to the same GO term. Therefore, all GO accessions were changed to their respecitve 'main id' and the dataset was again scanned for duplicates.

Table 1 provides information on the number of annotations that were removed this way from each dataset.
All further analyses were performed on the cleaned datasets since we assume the user will only be interested in still valid and non-redundant functional annotations.

# Results
... a quantitative comparison of the datasets in Table.

```{r cleanup_table}
dt2 <- read.csv("analyses/cleanup/results/cleanup_table.csv", header=T)
kable(dt2, booktabs=T, caption = "Number of removed annotations during cleanup.", col.names=c("Genome", "Dataset", "Obsolete Annotations", "Duplicates")) %>%
  kable_styling(latex_options = c("striped")) %>%
  collapse_rows(columns = 1, latex_hline="major")
```

```{r t_annotation_quantities}
dt2 <- read.csv("analyses/quantity/results/quantity_table.csv", header=T)
headers_above = c(a = 3, b = 4, c = 4, d =4)
names(headers_above) <- c(" ", 
  paste0("Annotations", footnote_marker_alphabet(1, double_escape=T)),
  paste0("Annotated Genes", footnote_marker_alphabet(2, double_escape=T)), 
  paste0("Median Ann. per G.", footnote_marker_alphabet(3, double_escape=T)))
kable(dt2, booktabs=T, caption = "Quantitative metrics of the cleaned functional annotation sets. C, F, P, and A refer to the aspects of the GO: Cellular Component, Biological Function, Molecular Process, and Any/All.", col.names=c("Genome", "Genes", "Dataset", "C", "F", "P", "A","C", "F", "P", "A","C", "F", "P", "A")) %>%
  kable_styling(latex_options = c("striped", "scale_down")) %>%
  add_header_above(headers_above, escape=F)%>%
  column_spec(c(15), bold = T) %>%
  column_spec(c(7,11), bold=T, border_right = T) %>%
  collapse_rows(columns = 1:2, latex_hline="major") %>%
  footnote(alphabet=c(
    "How many annotations in the C, F, and P aspect does this dataset contain? A = How many in total? $A = C + F + P$",
    "How many genes in the genome have at least one GO term from the C, F, P aspect annotated to them? A = How many at least one from any aspect? ($A = C \\\\cup F \\\\cup P$)",
    "Take a typical gene that is present in the annotation set. How many annotations does it have in each aspect? A = How many in total? Ask your favorite statistician why $A \\\\neq C + F +P$"
  ), threeparttable=T, escape=F)
```
